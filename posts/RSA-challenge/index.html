<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Master Challenge - De1 CTF" /><meta name="author" content="Vishvesh" /><meta property="og:locale" content="en" /><meta name="description" content="Writeup for Master Challenge De1 CTF" /><meta property="og:description" content="Writeup for Master Challenge De1 CTF" /><link rel="canonical" href="https://vishvesh-rao.github.io/posts/RSA-challenge/" /><meta property="og:url" content="https://vishvesh-rao.github.io/posts/RSA-challenge/" /><meta property="og:site_name" content="Stryd3r" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-05-11T17:55:28+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Master Challenge - De1 CTF" /><meta name="twitter:site" content="@The_Str1d3r" /><meta name="twitter:creator" content="@Vishvesh" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Vishvesh"},"description":"Writeup for Master Challenge De1 CTF","url":"https://vishvesh-rao.github.io/posts/RSA-challenge/","@type":"BlogPosting","headline":"Master Challenge - De1 CTF","dateModified":"2020-05-11T17:55:28+08:00","datePublished":"2020-05-11T17:55:28+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://vishvesh-rao.github.io/posts/RSA-challenge/"},"@context":"https://schema.org"}</script><title>Master Challenge - De1 CTF | Stryd3r</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Stryd3r"><meta name="application-name" content="Stryd3r"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://codimd.s3.shivering-isles.com/demo/uploads/02a6da1fb9d19367162f423a3.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Stryd3r</a></div><div class="site-subtitle font-italic">~Vishvesh, 21.y.o ~Blockchain security ~@team bi0s</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-user-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/presentations/" class="nav-link"> <i class="fa-fw fas fa-play ml-xl-3 mr-xl-3 unloaded"></i> <span>TALKS/PRESENTATIONS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/resume/" class="nav-link"> <i class="fa-fw fas fa-folder fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>RESUME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Vishvesh-rao" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/The_Str1d3r" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['vishveshsrao','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Master Challenge - De1 CTF</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Master Challenge - De1 CTF</h1><div class="post-meta text-muted"><div> By <em> <a href="https://www.linkedin.com/in/vishvesh-rao-847368191">Vishvesh_R</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2020-05-11 17:55:28 +0800" data-toggle="tooltip" data-placement="bottom" title="Mon, May 11, 2020, 5:55 PM +0800" >May 11, 2020</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="977 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><h2 id="overview">Overview<a href="#overview" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>This was one of the most interesting RSA challenges that I have solve till date. There are numerous points about this challenge that makes it so intriguing and unusual one of them being the hint (I will come to that later :p)<br /> One thing you would have noticed is how it seems that most of variables which have been used in the challenge script are not even acessible to the solver.</p><p>You would also notice that there are multiple ciphertexts, modlus, public exponents declared (some which we dont even know the value of).</p><p>Lets list them out in the order we’ll be finding them in:</p><ol><li><code class="language-plaintext highlighter-rouge">P</code><li>Public exponenets <code class="language-plaintext highlighter-rouge">e1</code> and <code class="language-plaintext highlighter-rouge">e2</code><li>Prime factors of <strong><em>n</em></strong> (<em>mentioned as <strong>n12</strong> in the <a href="https://github.com/Vishvesh-rao/CTF-Writeups/blob/master/Master%20challenge/data.py">data file</a></em>):<ol><li><code class="language-plaintext highlighter-rouge">q1p</code><li><code class="language-plaintext highlighter-rouge">q1q</code></ol><li>The <code class="language-plaintext highlighter-rouge">hint</code><li>The <code class="language-plaintext highlighter-rouge">flag</code></ol><p>All these variables might make this challenge look pretty baffling on the first glance but the key is solving it step by step getting each of the variable one(or two) at a time.</p><p>So lets get those variables <em>one at a time………</em></p><h2 id="the-approach">The Approach<a href="#the-approach" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="1-retrieving-p">#1. Retrieving <strong><code class="language-plaintext highlighter-rouge">p</code></strong><a href="#1-retrieving-p" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>This one was quite intuitive especially since the ciphertexts and modulus have been give in lists the lengths of which corresponds to 4. This is just a direct implementation of <a href="https://bitsdeep.com/posts/attacking-rsa-for-fun-and-ctf-points-part-2/">Hastards broadcast attack</a></p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>  <span class="n">f</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">c</span><span class="p">:</span><span class="nb">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">==</span><span class="n">c</span>
  <span class="k">assert</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">f</span><span class="p">,[</span><span class="n">p</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">c</span><span class="p">))</span><span class="o">==</span><span class="mi">4</span><span class="p">)</span>
</pre></table></code></div></div><p>The above code basically checks if <code class="language-plaintext highlighter-rouge">p</code><sup>4</sup> <code class="language-plaintext highlighter-rouge">modn</code> == <code class="language-plaintext highlighter-rouge">c</code> for all 4 values of <code class="language-plaintext highlighter-rouge">n</code> and <code class="language-plaintext highlighter-rouge">c</code>(taken from the lists)</p><p>Moving on to the next unknwon………</p><h3 id="2-retrieving-e1-and-e2">#2. Retrieving <strong><code class="language-plaintext highlighter-rouge">e1</code></strong> and <strong><code class="language-plaintext highlighter-rouge">e2</code></strong><a href="#2-retrieving-e1-and-e2" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Here is the part where we maybe slightly misled by the following lines of code:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">ee1</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">ee2</span> <span class="o">=</span> <span class="mi">3</span>
<span class="k">assert</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span><span class="n">ee1</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">==</span><span class="n">ce1</span><span class="p">)</span>
<span class="k">assert</span><span class="p">(</span><span class="nb">pow</span><span class="p">(</span><span class="n">e2</span><span class="o">+</span><span class="n">tmp</span><span class="p">,</span><span class="n">ee2</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="o">==</span><span class="n">ce2</span><span class="p">)</span>
</pre></table></code></div></div><p>At first glance it looks like we can retrive <code class="language-plaintext highlighter-rouge">e2+tmp</code> easily since the exponent <code class="language-plaintext highlighter-rouge">ee2</code>=3 is small but after implementation we see that <code class="language-plaintext highlighter-rouge">e2+tmp</code> is pretty big and is not susceptible to <a href="https://bitsdeep.com/posts/attacking-rsa-for-fun-and-ctf-points-part-2/">small exponent attack</a>. By thinking of small exponent attack we are on the right idea but the wrong path since this attack which is not working for <code class="language-plaintext highlighter-rouge">ee2</code> actually works for <code class="language-plaintext highlighter-rouge">ee1</code>=42. A direct implementation gets us the value of <code class="language-plaintext highlighter-rouge">e1</code>.</p><p>Going back to <code class="language-plaintext highlighter-rouge">e2</code>; since <code class="language-plaintext highlighter-rouge">e2+tmp</code> is really big there is no way we can directly bruteforce tha value of <code class="language-plaintext highlighter-rouge">e2</code> but again we are on the right idea but wrong way of implementation as in, instead of bruteforcing for the value directly we bruteforce to find the actul value of the ciphertext i.e the unmoded value which would be this <code class="language-plaintext highlighter-rouge">ce2+k*n11</code> by iterting for different values of <strong><code class="language-plaintext highlighter-rouge">k</code></strong> and matching this with <code class="language-plaintext highlighter-rouge">(e2+tmp)</code><sup>3</sup> we canget <code class="language-plaintext highlighter-rouge">e2</code>. Following is the implementation of the idea:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100000</span><span class="p">):</span>
	<span class="n">val</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="n">ce2</span><span class="o">+</span><span class="n">k</span><span class="o">*</span><span class="n">n11</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
	<span class="k">if</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
		<span class="n">e2</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">tmp</span>
</pre></table></code></div></div><p>Moving on to stage 3…………</p><h3 id="3-retrieving-q1p-and-q1q">#3 Retrieving <strong><code class="language-plaintext highlighter-rouge">q1p</code></strong> and <strong><code class="language-plaintext highlighter-rouge">q1q</code></strong><a href="#3-retrieving-q1p-and-q1q" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>For this there doesn’t seem to be any way in which we can exploit the implementation to obtain the cipher text with out <code class="language-plaintext highlighter-rouge">q1p</code> and <code class="language-plaintext highlighter-rouge">q1q</code> and they are the prime factors of the modulus and to obtain them the only way is factorization Since <strong>n</strong> is too long for normal factorization we use <a href="https://bitsdeep.com/posts/attacking-rsa-for-fun-and-ctf-points-part-2/">fermats method</a> and we immediately get both the factors.</p><p>Thereafter finding hint is just elementry RSA operation. The hint as it turns out to be: <strong><code class="language-plaintext highlighter-rouge">orz...you.found.me.but.sorry.no.hint...keep.on.and.enjoy.it!</code></strong> is pretty useless :) , still we got the factors with which we proceed to the last and final stage…………</p><h3 id="4-retrieving-the-flag">#4 Retrieving the <strong><code class="language-plaintext highlighter-rouge">flag</code></strong><a href="#4-retrieving-the-flag" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>This is arguably the most difficult value to retrieve amongst all and with good reason. All though it might look like its childs play to obin the flag as we know both the fctors of the modulus <strong><code class="language-plaintext highlighter-rouge">p</code></strong> and <strong><code class="language-plaintext highlighter-rouge">q1</code></strong> when we try decrypting we realize the flaw that is <strong><code class="language-plaintext highlighter-rouge">GCD(e1,(p-1)*(q1-1))</code></strong> turns out to be 14 if we try with e2 we get the same result.</p><p>Moment I saw this my first reaction was <em>dividing</em> <code class="language-plaintext highlighter-rouge">e2</code> ( or <code class="language-plaintext highlighter-rouge">e1</code>) by 14, this gives us a GCD of 1. good! Now we find the private exponent d.</p><p><em>NOTE: <strong>we are finding this for e/14</strong></em></p><p>now decrypting with this d what we get is <code class="language-plaintext highlighter-rouge">flag</code><sup>e1*d</sup><code class="language-plaintext highlighter-rouge">mod p*q1</code></p><p>But since this d was the modular inverse of (e1/14) and not e1 what we are left with is:</p><p>-&gt; <code class="language-plaintext highlighter-rouge">flag</code><sup>14<em>(e1/14)</em>d</sup><code class="language-plaintext highlighter-rouge">mod p*q1</code></p><p>-&gt; <code class="language-plaintext highlighter-rouge">flag</code><sup>14</sup><code class="language-plaintext highlighter-rouge">mod p*q1</code> as <code class="language-plaintext highlighter-rouge">(e2/14)*d</code>==1</p><p>Now if take the 14th root of flag we should end up with the pliantext Doing that we get flag and then we convert it to bytes and what we get is…. well its gibberish!! Meaning flag<sup>14</sup> is bigger than <code class="language-plaintext highlighter-rouge">p*q1</code></p><p>That means thats not the right way of doing ( again we are on the right idea but wrong track :D ) so if flag power 14 is too big how about reducing the power…………</p><p>Now lets take only q1 as the modulus. The idea here is that if q1 is less than <code class="language-plaintext highlighter-rouge">p*q1</code> we may be able to retrieve the flag so here’s what we do:</p><p>-&gt; c_modq = c_flag mod q1 (c_flag referenced as c1 in challenge script)</p><p>this makes some changes which we will see</p><p>-&gt; c_flag = <code class="language-plaintext highlighter-rouge">flag</code><sup>e1</sup><code class="language-plaintext highlighter-rouge">mod p*q1</code></p><p>-&gt; c_modq = (<code class="language-plaintext highlighter-rouge">flag</code><sup>e1</sup><code class="language-plaintext highlighter-rouge">mod p*q1</code>)<code class="language-plaintext highlighter-rouge">mod q1</code></p><p>-&gt; c_modq = (<code class="language-plaintext highlighter-rouge">flag</code><sup>e1</sup><code class="language-plaintext highlighter-rouge">mod q1</code>)<code class="language-plaintext highlighter-rouge">mod p*q1</code></p><p>Now <code class="language-plaintext highlighter-rouge">gcd(e2,(q2-1))</code>=2 so again we divide e2/2 and find <code class="language-plaintext highlighter-rouge">inverse(e2/2,(q2-1))</code> and we get d ( for e2/2 )</p><p>-&gt; <code class="language-plaintext highlighter-rouge">c_modq</code><sup>d</sup> = (<code class="language-plaintext highlighter-rouge">flag</code><sup>2<em>(e2/2)</em>d</sup><code class="language-plaintext highlighter-rouge">mod q2</code>)<code class="language-plaintext highlighter-rouge">mod p*q2</code></p><p>Hence we get (<code class="language-plaintext highlighter-rouge">flag</code><sup>2</sup><code class="language-plaintext highlighter-rouge">mod q1</code>)<code class="language-plaintext highlighter-rouge">mod p*q1</code> since <code class="language-plaintext highlighter-rouge">q1&lt;p*q1</code> we can ommit <code class="language-plaintext highlighter-rouge">mod p*q1</code></p><p>-&gt; <code class="language-plaintext highlighter-rouge">c_modq</code><sup>d</sup> = <code class="language-plaintext highlighter-rouge">flag</code><sup>2<em>(e2/2)</em>d</sup><code class="language-plaintext highlighter-rouge">mod q1</code> now assuming flag<sup>2</sup>&lt;q1 we can get <code class="language-plaintext highlighter-rouge">flag</code> by taking root</p><blockquote><p>For all this we haven’t taken into consideration <code class="language-plaintext highlighter-rouge">q2</code> as it is not greater than <code class="language-plaintext highlighter-rouge">flag</code><sup>2</sup> hence will not yield the flag when we attempt to take square root</p></blockquote><p>this is the exploit script for the idea:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">q1</span> <span class="o">=</span> <span class="n">q1p</span>
<span class="n">c1_modq</span> <span class="o">=</span> <span class="n">c_flag</span> <span class="o">%</span> <span class="n">q1</span>
<span class="n">GCD1</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="n">e1</span><span class="p">,</span><span class="n">q1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">d1</span> <span class="o">=</span> <span class="n">invert</span><span class="p">(</span><span class="n">e1</span><span class="o">/</span><span class="n">GCD1</span><span class="p">,</span><span class="n">q1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">c1_modq</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">c1_modq</span><span class="p">,</span><span class="n">d1</span><span class="p">,</span><span class="n">q1</span><span class="p">)</span>
<span class="n">flag</span> <span class="o">=</span> <span class="n">root</span><span class="p">(</span><span class="n">c1_modq</span><span class="p">,</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></table></code></div></div><p>In the end we get decrypted flag as: <strong><code class="language-plaintext highlighter-rouge">de1ctf{9b10a98b-71bb-4bdf-a6ff-f319943de21f}</code></strong></p><p>Here is the complete <a href="https://github.com/Vishvesh-rao/CTF-Writeups/blob/master/Master%20challenge/exploit.py">exploit</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf-wrtieups/'>CTF-Wrtieups</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/crypto/" class="post-tag no-text-decoration" >Crypto</a> <a href="/tags/rsa/" class="post-tag no-text-decoration" >RSA</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Master Challenge - De1 CTF - Stryd3r&url=https://vishvesh-rao.github.io/posts/RSA-challenge/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Master Challenge - De1 CTF - Stryd3r&u=https://vishvesh-rao.github.io/posts/RSA-challenge/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Master Challenge - De1 CTF - Stryd3r&url=https://vishvesh-rao.github.io/posts/RSA-challenge/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/STABLEMAGNET-RUGPULL/">STABLEMAGNET SWAP - ANALYSIS OF A RUGPULL</a><li><a href="/posts/Ankr-aBNBc-Token-Exploit/">Ankr aBNBc Token Exploit</a><li><a href="/posts/How-Not-To-Use-Custom-Errors/">How Not To Use Custom Errors</a><li><a href="/posts/Ethernaut-CTF-Writeups-Part-1/">Ethernaut CTF Writeups - Part 1</a><li><a href="/posts/Ethernaut-CTF-Writeups-Part-2/">Ethernaut CTF Writeups - Part 2</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ethereum/">Ethereum</a> <a class="post-tag" href="/tags/solidity/">Solidity</a> <a class="post-tag" href="/tags/crypto/">Crypto</a> <a class="post-tag" href="/tags/rsa/">RSA</a> <a class="post-tag" href="/tags/abnbc/">aBNBc</a> <a class="post-tag" href="/tags/aes-ecb/">AES-ECB</a> <a class="post-tag" href="/tags/bitcoin-protocols/">Bitcoin protocols</a> <a class="post-tag" href="/tags/bsc/">BSC</a> <a class="post-tag" href="/tags/eqn-solving/">eqn solving</a> <a class="post-tag" href="/tags/fwordctf/">FwordCTF</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Little-case/"><div class="card-body"> <em class="timeago small" date="2021-01-30 17:55:28 +0800" >Jan 30, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Little Case - * CTF</h3><div class="text-muted small"><p> Overview known values:- n1 e1 c ciphertext of mesg (taken as arguement by little_tricks()) n encrypted flag returned by real_trick() 1 2 3 4 5 6 7 8 9 n1 = 2166969987538734397576548...</p></div></div></a></div><div class="card"> <a href="/posts/My-Simple-Cipher.en/"><div class="card-body"> <em class="timeago small" date="2020-02-01 17:55:28 +0800" >Feb 1, 2020</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>My Simple Cipher - TWCTF</h3><div class="text-muted small"><p> Overview Of The Challenge The challenge involved an encryption program which performed the following encryption to genereate the cipher text: for i in range(0, len(message)): encrypted += chr((...</p></div></div></a></div><div class="card"> <a href="/posts/Locked-Dungeons-1/"><div class="card-body"> <em class="timeago small" date="2020-03-15 17:55:28 +0800" >Mar 15, 2020</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Locked Dungeons - SWAMP CTF</h3><div class="text-muted small"><p> Overview On the first glance itself you briefly get an idea that encryption program is an implementatioin of a modified AES-ECB encryption oracle along with the standard PKCS#11 padding. Declared...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Locked-Dungeons-1/" class="btn btn-outline-primary" prompt="Older"><p>Locked Dungeons - SWAMP CTF</p></a> <a href="/posts/Little-case/" class="btn btn-outline-primary" prompt="Newer"><p>Little Case - * CTF</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://www.linkedin.com/in/vishvesh-rao-847368191">Vishvesh_R</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ethereum/">Ethereum</a> <a class="post-tag" href="/tags/solidity/">Solidity</a> <a class="post-tag" href="/tags/crypto/">Crypto</a> <a class="post-tag" href="/tags/rsa/">RSA</a> <a class="post-tag" href="/tags/abnbc/">aBNBc</a> <a class="post-tag" href="/tags/aes-ecb/">AES-ECB</a> <a class="post-tag" href="/tags/bitcoin-protocols/">Bitcoin protocols</a> <a class="post-tag" href="/tags/bsc/">BSC</a> <a class="post-tag" href="/tags/eqn-solving/">eqn solving</a> <a class="post-tag" href="/tags/fwordctf/">FwordCTF</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>

<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Encrypted Operations - InCTF Internationals 2021" /><meta name="author" content="Vishvesh" /><meta property="og:locale" content="en" /><meta name="description" content="A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation." /><meta property="og:description" content="A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation." /><link rel="canonical" href="https://vishvesh-rao.github.io/posts/Encrypted-Operations-InCTFi21/" /><meta property="og:url" content="https://vishvesh-rao.github.io/posts/Encrypted-Operations-InCTFi21/" /><meta property="og:site_name" content="Stryd3r" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-20T20:30:06+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Encrypted Operations - InCTF Internationals 2021" /><meta name="twitter:site" content="@The_Str1d3r" /><meta name="twitter:creator" content="@Vishvesh" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Vishvesh"},"description":"A minimal, portfolio, sidebar, bootstrap Jekyll theme with responsive web design and focuses on text presentation.","url":"https://vishvesh-rao.github.io/posts/Encrypted-Operations-InCTFi21/","@type":"BlogPosting","headline":"Encrypted Operations - InCTF Internationals 2021","dateModified":"2021-08-20T20:30:06+08:00","datePublished":"2021-08-20T20:30:06+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://vishvesh-rao.github.io/posts/Encrypted-Operations-InCTFi21/"},"@context":"https://schema.org"}</script><title>Encrypted Operations - InCTF Internationals 2021 | Stryd3r</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Stryd3r"><meta name="application-name" content="Stryd3r"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://codimd.s3.shivering-isles.com/demo/uploads/02a6da1fb9d19367162f423a3.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Stryd3r</a></div><div class="site-subtitle font-italic">~Vishvesh, 21.y.o ~Blockchain security ~@team bi0s</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-user-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/presentations/" class="nav-link"> <i class="fa-fw fas fa-play ml-xl-3 mr-xl-3 unloaded"></i> <span>TALKS/PRESENTATIONS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/resume/" class="nav-link"> <i class="fa-fw fas fa-folder fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>RESUME</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Vishvesh-rao" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/The_Str1d3r" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['vishveshsrao','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Encrypted Operations - InCTF Internationals 2021</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Encrypted Operations - InCTF Internationals 2021</h1><div class="post-meta text-muted"><div> By <em> <a href="https://www.linkedin.com/in/vishvesh-rao-847368191">Vishvesh_R</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2021-08-20 20:30:06 +0800" data-toggle="tooltip" data-placement="bottom" title="Fri, Aug 20, 2021, 8:30 PM +0800" >Aug 20, 2021</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1760 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><html><head> <script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"> MathJax.Hub.Config({ "HTML-CSS": { availableFonts: ["TeX"], }, tex2jax: { inlineMath: [['$','$'],["\\(","\\)"]]}, displayMath: [ ['$$','$$'], ['\[','\]'] ], TeX: { extensions: ["AMSmath.js", "AMSsymbols.js", "color.js"], equationNumbers: { autoNumber: "AMS" } }, showProcessingMessages: false, messageStyle: "none", imageFont: null, "AssistiveMML": { disabled: true } }); </script><p><strong>tl;dr</strong></p><ul><li>Multiplying the middle element of 3x3 matrix with 9 gets thesum of all elements.<li>Adding the least element of 5x4 matrix with the larget and multiplying this result by 10 gets the sum of all elements.<li>multiplying any row with 2000 and subtrating that number by 2 will get you the sum.<li>Remaing two rows can be filled with the result of subtracting 9 from each digit of a corresponding row .</ul><p><strong>Challenge Points</strong>: 823 <strong>Challenge Author</strong>: <a href="https://twitter.com/The_Str1d3r">stryd3r</a></p><h2 id="challenge-description">Challenge Description<a href="#challenge-description" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>lets see how good you are at performing blind operations.</p><h2 id="overview">Overview<a href="#overview" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>We are provided with 2 files in c++.</p><ol><li><p><code class="language-plaintext highlighter-rouge">level.cpp</code> has two functions <code class="language-plaintext highlighter-rouge">level1()</code> and <code class="language-plaintext highlighter-rouge">level2()</code></p><li><p><code class="language-plaintext highlighter-rouge">utils.cpp</code> This contains some standard utility functions for parsing converting and encryption and decryption methods for FHE.</p></ol><p>From the challenge description given in <code class="language-plaintext highlighter-rouge">level.cpp</code> and briefly going through both the levels we can assume that we need to work on encrypted data throughout performing certain set of operations on it such that the decrypted value will pass some checks.</p><p>Lets analyse both the level functions one by one….</p><p><br /></p><h2 id="the-approach">The Approach<a href="#the-approach" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="1-analysing-level1">1. Analysing <strong>level1()</strong><a href="#1-analysing-level1" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><h4 id="a-level-1---part-1">a) Level 1 - Part 1<a href="#a-level-1---part-1" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>Looking at this function we see in the begining a $20×20$ square matrix is being generated</p><pre><code class="language-cpp=">    int SIZE = 20;
    int val = Genrand(1,500,0);
   
    std::vector&lt;std::vector&lt;int&gt; &gt; m(SIZE, std::vector&lt;int&gt;(SIZE));
    std::vector&lt;std::vector&lt;int&gt; &gt; v(169, std::vector&lt;int&gt;(9));
    std::vector&lt;int&gt; mat;

    for(int x = 0; x &lt; SIZE; x++){ 
        for(int y = 0; y &lt; SIZE; y++){
            m[x][y] = ++val;
        }
    }
</code></pre><p>We can see that a number is chosen randomly between $1$ and $500$ and that consequently is incremented by one resulting in $400$ consecuitve values with the random number being the initial state. All these $400$ values make up the $20×20$ matrix.</p><p>Moving on we see a bunch of for loops and allthough it might seem a bit complicated, simply executing this on any matrix and comparing the output with the original matrix values will tell us this is basically a collection of submatrices of the form $3×3$ that can be generated from the original matrix.</p><pre><code class="language-cpp=">    int d = m.size();
    int r = 3;
    int c = 3;

    for (int i = 0; i &lt; d-r+1; i++) {   
        for (int j = 0; j &lt; d-c+1; j++) {
            for (int p = 0; p &lt; r; p++) {
                for (int q = 0; q &lt; c; q++) {
                    mat.push_back(m[i+p][j+q]);
                }
            }
        }
    }
</code></pre><p>Now we come to the first challenge. Looking at the below code snippet…</p><pre><code class="language-cpp=">    idx = Genrand(0,v.size()-1,0);
    std::vector&lt;int64_t&gt; temp2(begin(v[idx]), end(v[idx]));
    msgvector = temp2;    
    
    FheEncrypt(msgvector);
</code></pre><p>here the plaintext vector which is encrypted by FHE is a $3×3$ sub matrix which is randomly chosen from the above list of submatrices. We can look at the check in the if condition —–&gt;</p><pre><code class="language-cpp=">  if (p[0] == sum)
    std::cout&lt;&lt;"Seems like you got a hang of this!!\nCongrats on completing the first level.\nGo get the flag!";
  else
    exit(0);
</code></pre><p>So we somehow need to make the first element of the plaintext vector p contain the sum of all elements in the randomly chosen $3×3$ sub matrix.</p><p>The server lets us pass a long int vector which we can create. we see the following operations are possible:</p><ul><li>Adiition (<strong>+</strong>)<li>Multiplication (<strong>*</strong>)<li>Vector Shift ( samt [<em>int</em>] -&gt; shift amount )<ul><li>left shift (<strong>&lt;</strong>)<li>right shift (<strong>&gt;</strong>)</ul></ul><p>So here the trick is to basically multiply the middle number of the $3\times3$ sub matrix with 9 and then do left shift 4 times to bring that number in 0th index of the vector!</p><p>The following set of input when sent to the corresponding prompts in the server will clear the first check in level 1:</p><ul><li><strong>{0,0,0,0,9,0,0,0,0}</strong>     <em>any vector with middle element with 9</em><li><strong>*</strong><li><strong>1</strong><li><strong>y</strong><li><strong>{0}</strong>    <em>any vector</em><li><strong>&lt;</strong><li><strong>4</strong><li><strong>n</strong></ul><p>Now onto the second part of level 2.</p><h4 id="b-level-1---part-2">b) Level 1 - Part 2<a href="#b-level-1---part-2" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>If you look at the code you will notice it is litrally a copy paste of the part 1 code. only difference is in the initial value assigned to matrix variables.</p><pre><code class="language-cpp="> DIFFERENCE:

  &gt; part 1
    r = 3;
    c = 3;
    
  &gt; part 2
    r = 5;
    c = 4;
</code></pre><p>So here the sub matrices generated are of dimension $5×4$ instead of $3×3$ as in part 1. sum of such a matrix can be calculated by $(first element + last element)\times10$</p><p>we need at least one element either first or last to do this below we recover the first element:</p><p>But there is one difference this time. a function which calculates a determinant is called twice and the resultant value is multiplied with the first element of $5\times4$ matrix, $num$</p><pre><code class="language-cpp=">calc_determinant(a, 2 * x) - calc_determinant(a, x);
gen_hint(a, x);
cout &lt;&lt; "This might make it easier: " &lt;&lt; res * num &lt;&lt; "\n\n";
</code></pre><p>A gen_hint() function is called with the variables used in the determinant and we are allowed to perforem some operations on these variables.</p><p>if we take $g(x)$ as the function which calculates the determinant ($a$ is a constant) then $g(x) = a(a+x)^{2}$ (reducing eqn in <code class="language-plaintext highlighter-rouge">calc_determinant()</code>)</p><p>so $g(2x) - g(x) = a(a+2x)^{2} - a(a+x)$ which gives $ax(2a+3x)$</p><p>in <code class="language-plaintext highlighter-rouge">gen_hint()</code> we see $hint*ax$ so we need hint to be $(2a+3x)$ we give the following inputs:</p><ul><li><strong>{2 3}</strong><li><strong>*</strong><li><strong>1</strong><li><strong>n</strong> and for choice we give ‘<strong>+</strong>’</ul><p>now we have $hint = ax(2a+3x)$ and we have $ax(2a+3x)*num$ ( $num$ being first element of $5\times4$ matrix) now dividing above two numbers we can obtain $num$ Again we need the 1st element of plaintext vector to be the sum of the sub matrix elements.</p><p>The following set of inputs will clear the part 2 check</p><ul><li><strong>{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,<code class="language-plaintext highlighter-rouge">num</code>}</strong>     <em>any vector with last element <code class="language-plaintext highlighter-rouge">var1</code></em><li><strong>+</strong><li><strong>1</strong><li><strong>y</strong><li><strong>{0}</strong>     <em>any vector</em><li><strong>&lt;</strong><li><strong>19</strong><li><strong>y</strong><li><strong>{10}</strong><li><strong>*</strong><li><strong>1</strong><li><strong>n</strong></ul><h3 id="2-analysing-level2">2. Analysing <strong>level2()</strong><a href="#2-analysing-level2" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Here we see a $5×5$ square matrix is generated initially assigned with random 1 digit values. Also the matrix index is always referenced through a randomly shuffled array containg the index values. But while assigning we notice for certain index value of the rows the whole row initialsed with $0’s$</p><blockquote><p>Also note on line 3 below that matrix row indices are stored in an array which is then shuffled. ```cpp= std::vector&lt;std::vector<int64_t> &gt; m1(MAT_SIZE, std::vector<int64_t>(MAT_SIZE));</int64_t></int64_t></p></blockquote><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>std::vector&lt;int&gt; row = {0,1,2,3,4};

std::random_device rd;
std::mt19937 g(rd());
 
std::shuffle(row.begin(), row.end(), g);
 
std::cout &lt;&lt;"\n\n--------LEVEL2---------\n\n";

for(int x = 0; x &lt; MAT_SIZE; x++){ 
   for(int y = 0; y &lt; MAT_SIZE; y++){
        if((x==row[0])||(x==row[1]))
            m1[x][y] = 0;
        else 
            m1[x][y] = Genrand(LOW,HIGH,0);
    }
} ```
</pre></table></code></div></div><p>Right after generation a row of the matrix is encrypted and we are again provided with the three usual prompts. Since we have not yet come across any check lets continue going through the code till we do.</p><p>Continuing through the code we come across two encryptions and both are encrypting an unknown (but distinct) row of the matrix and the reulting plaintext which is decrypted after the operations are performed on it is then added to the matrix rather a row is modified so that the new values of the row are the values of the plaintext vector. And the rows being modified are the ones which were earlier assigned with 0’s.</p><p>After modifying the matrix we see that the matrix row’s are basically being converted from 5 independent vectors to 5 numbers consisting of 5 digits so from ecah row we are parsing a 5 digit number and consequently we can see that all these numbers are added and their sum is stored.</p><pre><code class="language-cpp=">    for (int i = 0; i &lt; 5; i++)
        if(i == row[1])
            numVec.push_back(VecToNum(p1));
        else if(i == row[0])
            numVec.push_back(VecToNum(p2));
        else
            numVec.push_back(VecToNum(m1[i]));

    long int sum = accumulate(numVec.begin(), numVec.end(), 0);
</code></pre><p>Now we come to the final check ——–&gt;</p><pre><code class="language-cpp=">                                 Final Check
   if(sum==userInp){
        std::cout&lt;&lt;"\n\nYou have mastered encrypted operatoins!!\n";
        std::cout&lt;&lt;"Here's the flag: inctf{l0g1c_4nd_m4th_1s_4ll_1t_t00k!!}\n";     
    }
    else{
        std::cout&lt;&lt;"That was close, great going, But no flag for you!!\n\n";
        exit(0);
    }
</code></pre><p>Bringing all this together we finally get a idea of what is happening….</p><p>A $5×5$ square matrix is generated with 2 rows intialized with null values. we are given an encrypted row to perform operations on and the resulting plaintext is stored in <code class="language-plaintext highlighter-rouge">userinp</code>.</p><p>Next 2 rows are encrypted and the resulting plaintext is assigned to each of the 2 rows that were initialised with $0’s$ in the begining. And then all 5 rows are converted to corrsponding 5 digit numbers and their sum is taken this sum is checked with the initial <code class="language-plaintext highlighter-rouge">userinp</code>. A sucessfull check yeilds the flag.</p><p>So the first encrypted operations part, we are basically predicting what the sum will be. And in the second part where the two rows are modifed we are basically setting those rows such that the sum will is forced to be what we predicted earlier.</p><ul><li><p>So to get a correct predictoin of the sum we just need two add the digit 2 at the beginng of the 5 digit number in question and subtract 2 from the last digit*</p><li><p>Now to set the values of the row vectors such that the resulting two rows and the rest of the 3 rows add up to our predicted values we need to subtract each digit of the row or inthis case each element of the two rows with 9.*</p><li><p>since its a $5x5$ grid and we have generated two rows subtracting the other two rows with so when you add 4 out of these 5, 5 digit numbers we basicalli and up with $99999 + 99999$ ( since each of the two rows add up to $9$) and now we are left with the 5th row. Now if we add 2 to the sum of the 4 rows ie $99999 + 1 + 99999 + 1$ we get $200000$ and add this to the 5th number and subtract two and we get the final sum off all 5 numbers and this is exactly what we are doing in the prediction step.</p><li><p>we can also multiply the two rows with -1 and that will cancel out the result, the above method is without having any negetive digits in the vectors</p></ul><h4 id="final-set-of-inputs">Final set of inputs..<a href="#final-set-of-inputs" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>The following set of input when sent to the corresponding prompts in the server will clear the check in level 2:</p><ul><li><h5 id="1st-set-of-inputs"><em>1st set of inputs</em><a href="#1st-set-of-inputs" class="anchor"><i class="fas fa-hashtag"></i></a></h5></h5><ul><li><strong>{0}</strong>     <em>any vector will suffice</em><li><strong>&gt;</strong><li><strong>1</strong><li><strong>y</strong><li><strong>{2}</strong><li><strong>+</strong><li><strong>1</strong><li><strong>y</strong><li><strong>{0,0,0,0,0,-2}</strong><li><strong>+</strong><li><strong>1</strong><li><strong>n</strong></ul><li><h5 id="2nd-set-of-inputs"><em>2nd set of inputs</em><a href="#2nd-set-of-inputs" class="anchor"><i class="fas fa-hashtag"></i></a></h5></h5><ul><li><strong>{-9,-9,-9,-9,-9}</strong><li><strong>+</strong><li><strong>1</strong><li><strong>y</strong><li><strong>{-1,-1,-1,-1,-1}</strong><li><strong>*</strong><li><strong>1</strong><li><strong>n</strong></ul><li><h5 id="3rd-set-of-inputs"><em>3rd set of inputs</em><a href="#3rd-set-of-inputs" class="anchor"><i class="fas fa-hashtag"></i></a></h5></h5><ul><li><strong>{-9,-9,-9,-9,-9}</strong><li><strong>+</strong><li><strong>0</strong><li><strong>y</strong><li><strong>{-1,-1,-1,-1,-1}</strong><li><strong>*</strong><li><strong>1</strong><li><strong>n</strong></ul></ul><p><br /></p><h2 id="conclusion">Conclusion<a href="#conclusion" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><strong><em>WITH THAT U HAVE PASSED ALL THREE CHECKS!!!!!!</em></strong></p><p>You can find the full exploit <a href="https://gist.github.com/Vishvesh-rao/138489667dc8f79ae8aa7bef8b7e5ebf">here</a>.</p><p>flag: <code class="language-plaintext highlighter-rouge">inctfi{m4st3r_0f_Encrypt3d_0p3r4t1on5_B3c0m3_u_H4v3!!}</code></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf-wrtieups/'>CTF-Wrtieups</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/inctfi/" class="post-tag no-text-decoration" >InCTFi</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Encrypted Operations - InCTF Internationals 2021 - Stryd3r&url=https://vishvesh-rao.github.io/posts/Encrypted-Operations-InCTFi21/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Encrypted Operations - InCTF Internationals 2021 - Stryd3r&u=https://vishvesh-rao.github.io/posts/Encrypted-Operations-InCTFi21/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Encrypted Operations - InCTF Internationals 2021 - Stryd3r&url=https://vishvesh-rao.github.io/posts/Encrypted-Operations-InCTFi21/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/STABLEMAGNET-RUGPULL/">STABLEMAGNET SWAP - ANALYSIS OF A RUGPULL</a><li><a href="/posts/Ankr-aBNBc-Token-Exploit/">Ankr aBNBc Token Exploit</a><li><a href="/posts/How-Not-To-Use-Custom-Errors/">How Not To Use Custom Errors</a><li><a href="/posts/Ethernaut-CTF-Writeups-Part-1/">Ethernaut CTF Writeups - Part 1</a><li><a href="/posts/Ethernaut-CTF-Writeups-Part-2/">Ethernaut CTF Writeups - Part 2</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ethereum/">Ethereum</a> <a class="post-tag" href="/tags/solidity/">Solidity</a> <a class="post-tag" href="/tags/crypto/">Crypto</a> <a class="post-tag" href="/tags/rsa/">RSA</a> <a class="post-tag" href="/tags/abnbc/">aBNBc</a> <a class="post-tag" href="/tags/aes-ecb/">AES-ECB</a> <a class="post-tag" href="/tags/bitcoin-protocols/">Bitcoin protocols</a> <a class="post-tag" href="/tags/bsc/">BSC</a> <a class="post-tag" href="/tags/eqn-solving/">eqn solving</a> <a class="post-tag" href="/tags/fwordctf/">FwordCTF</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Login-Fword_21/"><div class="card-body"> <em class="timeago small" date="2021-08-31 20:30:06 +0800" >Aug 31, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Login - Fword CTF 2021</h3><div class="text-muted small"><p> tl;dr use hash extension to bypass password check on login. use RSA properties to recover $q$ and get $p$ and therefore $N= p*q$. sign the message given, and get the flag. ...</p></div></div></a></div><div class="card"> <a href="/posts/My-Simple-Cipher.en/"><div class="card-body"> <em class="timeago small" date="2020-02-01 17:55:28 +0800" >Feb 1, 2020</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>My Simple Cipher - TWCTF</h3><div class="text-muted small"><p> Overview Of The Challenge The challenge involved an encryption program which performed the following encryption to genereate the cipher text: for i in range(0, len(message)): encrypted += chr((...</p></div></div></a></div><div class="card"> <a href="/posts/Locked-Dungeons-1/"><div class="card-body"> <em class="timeago small" date="2020-03-15 17:55:28 +0800" >Mar 15, 2020</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Locked Dungeons - SWAMP CTF</h3><div class="text-muted small"><p> Overview On the first glance itself you briefly get an idea that encryption program is an implementatioin of a modified AES-ECB encryption oracle along with the standard PKCS#11 padding. Declared...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Little-case/" class="btn btn-outline-primary" prompt="Older"><p>Little Case - * CTF</p></a> <a href="/posts/Login-Fword_21/" class="btn btn-outline-primary" prompt="Newer"><p>Login - Fword CTF 2021</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://www.linkedin.com/in/vishvesh-rao-847368191">Vishvesh_R</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ethereum/">Ethereum</a> <a class="post-tag" href="/tags/solidity/">Solidity</a> <a class="post-tag" href="/tags/crypto/">Crypto</a> <a class="post-tag" href="/tags/rsa/">RSA</a> <a class="post-tag" href="/tags/abnbc/">aBNBc</a> <a class="post-tag" href="/tags/aes-ecb/">AES-ECB</a> <a class="post-tag" href="/tags/bitcoin-protocols/">Bitcoin protocols</a> <a class="post-tag" href="/tags/bsc/">BSC</a> <a class="post-tag" href="/tags/eqn-solving/">eqn solving</a> <a class="post-tag" href="/tags/fwordctf/">FwordCTF</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
